<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:jsf="http://xmlns.jcp.org/jsf"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        template="/WEB-INF/layout/public.xhtml">
    <ui:define name="body">

        <h:form id="trackingForm" styleClass="row g-3">
            <div class="col-auto"><span class="form-control-plaintext">Enter your tracking ID:</span></div>
            <div class="col-auto">
                <input type="text" jsf:id="trackingIdInput"
                       class="form-control"
                       jsf:value="#{public.track.trackingId}" jsf:required="true"
                       placeholder="XYZ789" title="Valid tracking ID"/>
            </div>
            <div class="col-auto">
                <button class="btn btn-primary mb-3" jsf:action="#{public.track.onTrackById()}">Track!</button>
            </div>
        </h:form>

        <ui:fragment rendered="#{not empty public.track.cargo}">
            <div class="row g-3 my-5 me-3">
                <div class="col-12 col-md-6">
                    <p>
                        Cargo <strong>#{public.track.cargo.trackingId}</strong> is
                        currently <strong>#{public.track.cargo.statusText}</strong>
                    </p>

                    <p>
                        Estimated time of arrival in <strong>#{public.track.cargo.destinationName}</strong>:
                        #{public.track.cargo.eta}
                    </p>
                    <ui:fragment
                            rendered="#{not empty public.track.cargo.nextExpectedActivity}">
                        <p>#{public.track.cargo.nextExpectedActivity}</p>
                    </ui:fragment>

                    <ui:fragment rendered="#{public.track.cargo.misdirected}">
                        <p>
                            <i class="fa fa-exclamation-triangle" style="color: #9b2332"></i>
                            Cargo is misdirected.
                        </p>
                    </ui:fragment>
                    <p class="m-2 fs-2">Handling History </p>

                    <ui:fragment rendered="#{empty public.track.cargo.events}">
                        <p>
                            There are no events recorded for the tracking ID #{public.track.cargo.trackingId}."
                        </p>
                    </ui:fragment>


                    <ui:repeat value="#{public.track.cargo.events}" var="leg">
                        <div>
                            <ui:fragment rendered="#{leg.expected}">
                                <i class="bi bi-check-circle text-success me-1"></i>#{leg.description}, at #{leg.time}
                            </ui:fragment>
                            <ui:fragment rendered="#{!leg.expected}">
                                <i class="bi bi-x-circle text-danger me-1"></i>#{leg.description}, at #{leg.time}
                            </ui:fragment>
                        </div>
                    </ui:repeat>
                </div>
                <div class="col-12 col-md-6">
                    <iframe class="mapFrame" width="100%" height="960" frameBorder="0"
                            src="#{request.contextPath}/public/mapFrame.xhtml?statusCode=#{public.track.cargo.statusCode}&amp;lastKnownLocationCode=#{public.track.cargo.lastKnownLocationCode}&amp;lastKnownLocationName=#{public.track.cargo.lastKnownLocationName}&amp;originCode=#{public.track.cargo.originCode}&amp;originName=#{public.track.cargo.originName}&amp;destinationCode=#{public.track.cargo.destinationCode}&amp;destinationName=#{public.track.cargo.destinationName}"/>
                </div>
            </div>
        </ui:fragment>
    </ui:define>
</ui:composition>
